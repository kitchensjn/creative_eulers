<style>
    .kg_stage1, .kg_stage2, .kg_stage3, .kg_stage4, .kg_stage5, .kg_stage6 {
        display: none;
        opacity: 0;
        transition: 1s;
    }
</style>

<div id="thousand_genomes" class="carousel-item full grid-background">
    <svg class="figure" viewBox="0 0 1000 1000">
        <g class="text-content">
            <g class="kg_stage0">
                <text x="100" y="100">The 1000 Genomes Project sampled individuals from</text>
                <text x="100" y="150">around the world, including 609 individuals from</text>
                <text x="100" y="200">seven groups in the Americas. The rest of this</text>
                <text x="100" y="250">activity will focus on these individuals.</text>
            </g>
            <g class="kg_stage1">
                <text x="100" y="100">Across the 609 individuals from the Americas, the</text>
                <text x="100" y="150"><tspan font-weight="bold">majority of sites between their genomes are not</tspan></text>
                <text x="100" y="200"><tspan font-weight="bold">polymorphic.</tspan></text>
            </g>
            <g class="kg_stage2">
                <text x="100" y="100">Even when the site is polymorphic, <tspan font-weight="bold">the mutation is</tspan></text>
                <text x="100" y="150"><tspan font-weight="bold">often found at a low frequency</tspan>. Here, we observe</text>
                <text x="100" y="200">only 10 million sites where the mutation is found</text>
                <text x="100" y="250">at >5% in any of the Americas' subgroups.</text>
            </g>
            <g class="kg_stage3">
                <text x="100" y="100">For these three subgroups from the Americas, <tspan font-weight="bold">each</tspan></text>
                <text x="100" y="150"><tspan font-weight="bold">circle is sized proportionally to the number of</tspan></text>
                <text x="100" y="200"><tspan font-weight="bold">common variants</tspan> found in that subgroup. We are</text>
                <text x="100" y="250">going to create Euler diagrams for the three different</text>
                <text x="100" y="300">pairings of these subgroups.</text>
            </g>
            <g class="kg_stage4 kg_stage5 kg_stage6">
                <text x="100" y="100"><tspan font-weight="bold">Slide the circles to estimate the amount of overlap</tspan></text>
                <text x="100" y="150"><tspan font-weight="bold">in common genetic variation between the specified</tspan></text>
                <text x="100" y="200"><tspan font-weight="bold">subgroups.</tspan> The starting position is random.</text>
            </g>
        </g>
        <g class="diagram">
            <g class="subgroups">
                <g class="kg_stage4">
                    <g>
                        <text x="300" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">African Caribbean in</text>
                        <text x="300" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">Barbados</text>
                    </g>
                    <g>
                        <text x="700" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Utah residents (CEPH) with</text>
                        <text x="700" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Northern and Western</text>
                        <text x="700" y="350" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">European ancestry</text>
                    </g>
                </g>
                <g class="kg_stage5">
                    <g>
                        <text x="300" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">African Caribbean in</text>
                        <text x="300" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">Barbados</text>
                    </g>
                    <g>
                        <text x="700" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Mexican Ancestry in</text>
                        <text x="700" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Los Angeles, California</text>
                    </g>
                </g>
                <g class="kg_stage6">
                    <g>
                        <text x="300" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Utah residents (CEPH) with</text>
                        <text x="300" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Northern and Western</text>
                        <text x="300" y="350" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">European ancestry</text>
                    </g>
                    <g>
                        <text x="700" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Mexican Ancestry in</text>
                        <text x="700" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Los Angeles, California</text>
                    </g>
                </g>
            </g>
            <g class="kg_stage0"></g>
            <g class="kg_stage1 kg_stage2">
                <g id="genome_circle"></g>
                <g id="variants_circle"></g>
            </g>
            <g class="kg_stage2">
                <g id="common_circle"></g>
            </g>
            <g class="kg_stage3">
                <g id="ACB_circle"></g>
                <g id="CEU_circle"></g>
                <g id="MXL_circle"></g>
            </g>
            <g class="kg_stage4">
                <g id="ACB_CEU_ACB"></g>
                <g id="ACB_CEU_CEU"></g>
            </g>
            <g class="kg_stage5">
                <g id="ACB_MXL_ACB"></g>
                <g id="ACB_MXL_MXL"></g>
            </g>
            <g class="kg_stage6">
                <g id="CEU_MXL_CEU"></g>
                <g id="CEU_MXL_MXL"></g>
            </g>
            <g class="annotations">
                <g class="kg_stage1 kg_stage2">
                    <g id="measureable">
                        <line x1="340" y1="675" x2="315" y2="700" stroke="black" stroke-width="1"></line>
                        <line x1="315" y1="700" x2="290" y2="700" stroke="black" stroke-width="1"></line>
                        <text x="160" y="675" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Measurable locations</text>
                        <text x="160" y="700" text-anchor="middle" dominant-baseline="central" font-size="0.7em">in the human genome</text>
                        <text x="160" y="725" text-anchor="middle" dominant-baseline="central" font-size="0.7em">(~2.9 billion sites)</text>
                    </g>
                    <g id="observed">
                        <line x1="425" y1="475" x2="450" y2="450" stroke="black" stroke-width="1"></line>
                        <line x1="450" y1="450" x2="475" y2="450" stroke="black" stroke-width="1"></line>
                        <text x="585" y="435" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Observed variants</text>
                        <text x="585" y="460" text-anchor="middle" dominant-baseline="central" font-size="0.7em">(~39 million sites)</text>
                    </g>
                </g>
                <g class="kg_stage2">
                    <g>
                        <line x1="400" y1="565" x2="425" y2="590" stroke="black" stroke-width="1"></line>
                        <line x1="425" y1="590" x2="450" y2="590" stroke="black" stroke-width="1"></line>
                        <text x="560" y="575" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Common variants</text>
                        <text x="560" y="600" text-anchor="middle" dominant-baseline="central" font-size="0.7em">(~10 million sites)</text>
                    </g>
                </g>
            </g>
            <g class="answers">
                <g class="kg_stage4">
                    <text x="500" y="775" text-anchor="middle" dominant-baseline="central">Your diagram shows a <tspan id="byo_answer1" font-weight="bold" dominant-baseline="central">X%</tspan> overlap.</text>
                </g>
                <g class="kg_stage5">
                    <text x="500" y="775" text-anchor="middle" dominant-baseline="central">Your diagram shows a <tspan id="byo_answer2" font-weight="bold" dominant-baseline="central">X%</tspan> overlap.</text>
                </g>
                <g class="kg_stage6">
                    <text x="500" y="775" text-anchor="middle" dominant-baseline="central">Your diagram shows a <tspan id="byo_answer2" font-weight="bold" dominant-baseline="central">X%</tspan> overlap.</text>
                </g>
            </g>
        </g>
        <g class="buttons">
            <g id="kg0_buttons" class="kg_stage0"></g>
            <g id="kg1_buttons" class="kg_stage1"></g>
            <g id="kg2_buttons" class="kg_stage2"></g>
            <g id="kg3_buttons" class="kg_stage3"></g>
            <g id="kg4_buttons" class="kg_stage4"></g>
            <g id="kg5_buttons" class="kg_stage5"></g>
        </g>
    </svg>

    <script>
        d3.selectAll(".kg_stage0").style("display", "block");
        d3.selectAll(".kg_stage0").style("opacity", "1");


        create_circle("genome_circle", 500, 500, 467.5491/2);
        create_circle("variants_circle", 400, 500, 54.2945/2, "rgba(255,0,0,0.2)");
        
        create_circle("common_circle", 400, 555, 27.4473/2, "rgba(0,0,255,0.2)");

        create_circle("ACB_circle", 400, 500, 213.02/2, "rgba(255,0,0,0.2)");
        create_circle("CEU_circle", 600, 550, 180/2, "rgba(0,255,0,0.2)");
        create_circle("MXL_circle", 470, 690, 179.02/2, "rgba(0,0,255,0.2)");


        create_interactive_circle("ACB_CEU_ACB", random_between(400, 600), 550, 213.02/2, "rgba(255,0,0,0.2)");
        create_interactive_circle("ACB_CEU_CEU", random_between(400, 600), 550, 180/2, "rgba(0,255,0,0.2)");

        create_interactive_circle("ACB_MXL_ACB", random_between(400, 600), 550, 213.02/2, "rgba(255,0,0,0.2)");
        create_interactive_circle("ACB_MXL_MXL", random_between(400, 600), 550, 179.02/2, "rgba(0,0,255,0.2)");

        create_interactive_circle("CEU_MXL_CEU", random_between(400, 600), 550, 180/2, "rgba(0,255,0,0.2)");
        create_interactive_circle("CEU_MXL_MXL", random_between(400, 600), 550, 179.02/2, "rgba(0,0,255,0.2)");

        create_button("kg0_buttons", "kg0_next", "Next", 450, 850, 100, 50);
        create_button("kg1_buttons", "kg1_next", "Next", 450, 850, 100, 50);
        create_button("kg2_buttons", "kg2_next", "Next", 450, 850, 100, 50);
        create_button("kg3_buttons", "kg3_next", "Next", 450, 850, 100, 50);
        create_button("kg4_buttons", "kg4_next", "Submit", 425, 850, 150, 50);
        create_button("kg5_buttons", "kg5_next", "Submit", 425, 850, 150, 50);

        d3.select("#kg0_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage0").style("display", "none");
                d3.selectAll(".kg_stage1").style("display", "block").transition().style("opacity", "1");
            });

        d3.select("#kg1_next")
            .on("click", function(event, d) {
                d3.selectAll("#genome_circle").transition().attr("transform", "translate(0, 55)");
                d3.selectAll("#variants_circle").transition().attr("transform", "translate(0, 55)");

                d3.selectAll("#variants_circle>path").style("fill", "none");

                d3.selectAll("#measureable").transition().attr("transform", "translate(0, 55)");
                d3.selectAll("#observed").transition().attr("transform", "translate(0, 55)");
                
                d3.selectAll(".kg_stage1").style("display", "none");
                d3.selectAll(".kg_stage2").style("display", "block").transition().style("opacity", "1");
            });
        
        d3.select("#kg2_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage2").style("display", "none");
                d3.selectAll(".kg_stage3").style("display", "block").transition().style("opacity", "1");
            });

        d3.select("#kg3_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage3").style("display", "none");
                d3.selectAll(".kg_stage4").style("display", "block").transition().style("opacity", "1");
            });

        d3.select("#kg4_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage4").style("display", "none");
                d3.selectAll(".kg_stage5").style("display", "block").transition().style("opacity", "1");
            });
        
        d3.select("#kg5_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage5").style("display", "none");
                d3.selectAll(".kg_stage6").style("display", "block").transition().style("opacity", "1");
            });
        
    </script>
</div>