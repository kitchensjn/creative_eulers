<style>
    .kg_stage1, .kg_stage2, .kg_stage3, .kg_stage4, .kg_stage5, .kg_stage6, .kg_stage7 {
        display: none;
        opacity: 0;
        transition: 1s;
    }
</style>

<div id="thousand_genomes" class="carousel-item full grid-background">
    <svg class="figure" viewBox="0 0 1000 1000">
        <g class="text-content">
            <g class="kg_stage0">
                <text x="100" y="100">The 1000 Genomes Project sampled individuals from</text>
                <text x="100" y="150">around the world, including 609 individuals from</text>
                <text x="100" y="200">seven groups in the Americas. The rest of this</text>
                <text x="100" y="250">activity will focus on these individuals.</text>
                <text x="500" y="500" text-anchor="middle" dominant-baseline="central">ADD MAP</text>
            </g>
            <g class="kg_stage1">
                <text x="100" y="100">Across the 609 individuals from the Americas, the</text>
                <text x="100" y="150"><tspan font-weight="bold">majority of sites between their genomes are not</tspan></text>
                <text x="100" y="200"><tspan font-weight="bold">polymorphic.</tspan></text>
            </g>
            <g class="kg_stage2">
                <text x="100" y="100">Even when the site is polymorphic, <tspan font-weight="bold">the mutation is</tspan></text>
                <text x="100" y="150"><tspan font-weight="bold">often found at a low frequency</tspan>. Here, we observe</text>
                <text x="100" y="200">only 10 million sites where the mutation is found</text>
                <text x="100" y="250">at >5% in any of the Americas' subgroups.</text>
            </g>
            <g class="kg_stage3">
                <text x="100" y="100">For these three subgroups from the Americas, <tspan font-weight="bold">each</tspan></text>
                <text x="100" y="150"><tspan font-weight="bold">circle is sized proportionally to the number of</tspan></text>
                <text x="100" y="200"><tspan font-weight="bold">common variants</tspan> found in that subgroup. We are</text>
                <text x="100" y="250">going to create Euler diagrams for the three different</text>
                <text x="100" y="300">pairings of these subgroups.</text>
            </g>
            <g class="kg_stage4 kg_stage5 kg_stage6">
                <text x="100" y="100"><tspan font-weight="bold">Slide the circles to estimate the amount of overlap</tspan></text>
                <text x="100" y="150"><tspan font-weight="bold">in common genetic variation between the specified</tspan></text>
                <text x="100" y="200"><tspan font-weight="bold">subgroups.</tspan> The starting position is random.</text>
            </g>
            <g class="kg_stage7">
                <text x="100" y="100"><tspan font-weight="bold">Compare your guesses to the observed amount</tspan></text>
                <text x="100" y="150"><tspan font-weight="bold">of overlap in common genetic variation between</tspan></text>
                <text x="100" y="200"><tspan font-weight="bold">the subgroups in the 1000 Genomes Project.</tspan></text>
            </g>
        </g>
        <g class="diagram">
            <g class="subgroups">
                <g class="kg_stage4">
                    <g>
                        <text x="300" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">African Caribbean in</text>
                        <text x="300" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">Barbados</text>
                    </g>
                    <g>
                        <text x="700" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Utah residents (CEPH) with</text>
                        <text x="700" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Northern and Western</text>
                        <text x="700" y="350" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">European ancestry</text>
                    </g>
                </g>
                <g class="kg_stage5">
                    <g>
                        <text x="300" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">African Caribbean in</text>
                        <text x="300" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="red">Barbados</text>
                    </g>
                    <g>
                        <text x="700" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Mexican Ancestry in</text>
                        <text x="700" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Los Angeles, California</text>
                    </g>
                </g>
                <g class="kg_stage6">
                    <g>
                        <text x="300" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Utah residents (CEPH) with</text>
                        <text x="300" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">Northern and Western</text>
                        <text x="300" y="350" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="green">European ancestry</text>
                    </g>
                    <g>
                        <text x="700" y="300" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Mexican Ancestry in</text>
                        <text x="700" y="325" text-anchor="middle" dominant-baseline="central" font-size=0.7em fill="blue">Los Angeles, California</text>
                    </g>
                </g>
            </g>
            <g class="kg_stage0"></g>
            <g class="kg_stage1 kg_stage2">
                <g id="genome_circle"></g>
                <g id="variants_circle"></g>
            </g>
            <g class="kg_stage2">
                <g id="common_circle"></g>
            </g>
            <g class="kg_stage3">
                <g id="ACB_circle"></g>
                <g id="CEU_circle"></g>
                <g id="MXL_circle"></g>
            </g>
            <g class="kg_stage4">
                <g id="ACB_CEU_ACB" class="interactive_circle"></g>
                <g id="ACB_CEU_CEU" class="interactive_circle"></g>
            </g>
            <g class="kg_stage5">
                <g id="ACB_MXL_ACB" class="interactive_circle"></g>
                <g id="ACB_MXL_MXL" class="interactive_circle"></g>
            </g>
            <g class="kg_stage6">
                <g id="CEU_MXL_CEU" class="interactive_circle"></g>
                <g id="CEU_MXL_MXL" class="interactive_circle"></g>
            </g>
            <g class="kg_stage7">
                <text x="200" y="300" text-anchor="middle" dominant-baseline="central">Your Guess</text>
                <text x="800" y="285" text-anchor="middle" dominant-baseline="central">1000 Genomes</text>
                <text x="800" y="315" text-anchor="middle" dominant-baseline="central">Project</text>
                <text x="200" y="410" font-size=1.5em text-anchor="middle" dominant-baseline="central" id="kg_answer1_table">X%</text>
                <text x="500" y="385" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="red">African Caribbean in Barbados</text>
                <text x="500" y="410" font-size=0.7em text-anchor="middle" dominant-baseline="central">-</text>
                <text x="500" y="435" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="green">Utah residents (CEPH) with Northern</text>
                <text x="500" y="460" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="green">and Western European ancestry</text>
                <text x="800" y="410" font-size=1.5em text-anchor="middle" dominant-baseline="central">51%</text>
                <text x="200" y="560" font-size=1.5em text-anchor="middle" dominant-baseline="central" id="kg_answer2_table">X%</text>
                <text x="500" y="535" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="red">African Caribbean in Barbados</text>
                <text x="500" y="560" font-size=0.7em text-anchor="middle" dominant-baseline="central">-</text>
                <text x="500" y="585" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="blue">Mexican Ancestry in Los Angeles,</text>
                <text x="500" y="610" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="blue">California</text>
                <text x="800" y="560" font-size=1.5em text-anchor="middle" dominant-baseline="central">52%</text>
                <text x="200" y="710" font-size=1.5em text-anchor="middle" dominant-baseline="central" id="kg_answer3_table">X%</text>
                <text x="500" y="660" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="green">Utah residents (CEPH) with Northern</text>
                <text x="500" y="685" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="green">and Western European ancestry</text>
                <text x="500" y="710" font-size=0.7em text-anchor="middle" dominant-baseline="central">-</text>
                <text x="500" y="735" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="blue">Mexican Ancestry in Los Angeles,</text>
                <text x="500" y="760" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="blue">California</text>
                <text x="800" y="710" font-size=1.5em text-anchor="middle" dominant-baseline="central">78%</text>
            </g>
            <g class="annotations">
                <g class="kg_stage1 kg_stage2">
                    <g id="measureable">
                        <line x1="340" y1="675" x2="315" y2="700" stroke="black" stroke-width="1"></line>
                        <line x1="315" y1="700" x2="290" y2="700" stroke="black" stroke-width="1"></line>
                        <text x="160" y="675" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Measurable locations</text>
                        <text x="160" y="700" text-anchor="middle" dominant-baseline="central" font-size="0.7em">in the human genome</text>
                        <text x="160" y="725" text-anchor="middle" dominant-baseline="central" font-size="0.7em">(~2.9 billion sites)</text>
                    </g>
                    <g id="observed">
                        <line x1="425" y1="475" x2="450" y2="450" stroke="black" stroke-width="1"></line>
                        <line x1="450" y1="450" x2="475" y2="450" stroke="black" stroke-width="1"></line>
                        <text x="585" y="435" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Observed variants</text>
                        <text x="585" y="460" text-anchor="middle" dominant-baseline="central" font-size="0.7em">(~39 million sites)</text>
                    </g>
                </g>
                <g class="kg_stage2">
                    <g>
                        <line x1="400" y1="565" x2="425" y2="590" stroke="black" stroke-width="1"></line>
                        <line x1="425" y1="590" x2="450" y2="590" stroke="black" stroke-width="1"></line>
                        <text x="560" y="575" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Common variants</text>
                        <text x="560" y="600" text-anchor="middle" dominant-baseline="central" font-size="0.7em">(~10 million sites)</text>
                    </g>
                </g>
                <g class="kg_stage3">
                    <g>
                        <line x1="350" y1="425" x2="325" y2="400" stroke="black" stroke-width="1"></line>
                        <line x1="300" y1="400" x2="325" y2="400" stroke="black" stroke-width="1"></line>
                        <text x="200" y="385" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="red">African Caribbean</text>
                        <text x="200" y="415" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="red">in Barbados</text>
                        <text x="400" y="500" font-size=0.7em text-anchor="middle" dominant-baseline="central">8,018,649</text>
                    </g>
                    <g>
                        <line x1="600" y1="460" x2="625" y2="435" stroke="black" stroke-width="1"></line>
                        <line x1="625" y1="435" x2="650" y2="435" stroke="black" stroke-width="1"></line>
                        <text x="800" y="405" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="green">Utah residents (CEPH)</text>
                        <text x="800" y="435" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="green">with Northern and Western</text>
                        <text x="800" y="465" font-size=0.7em text-anchor="middle" dominant-baseline="central" fill="green">European ancestry</text>
                        <text x="600" y="550" font-size=0.7em text-anchor="middle" dominant-baseline="central">5,726,377</text>
                    </g>
                    <g>
                        <line x1="550" y1="715" x2="575" y2="740" stroke="black" stroke-width="1"></line>
                        <line x1="575" y1="740" x2="600" y2="740" stroke="black" stroke-width="1"></line>
                        <text x="725" y="725" text-anchor="middle" dominant-baseline="central" font-size="0.7em" fill="blue">Mexican Ancestry in</text>
                        <text x="725" y="755" text-anchor="middle" dominant-baseline="central" font-size="0.7em" fill="blue">Los Angeles, California</text>
                        <text x="470" y="690" font-size=0.7em text-anchor="middle" dominant-baseline="central">5,663,208</text>
                    </g>
                </g>
            </g>
            <g class="answers">
                <g class="kg_stage4">
                    <text x="500" y="775" text-anchor="middle" dominant-baseline="central">Your diagram shows a <tspan id="kg_answer1" font-weight="bold" dominant-baseline="central">X%</tspan> overlap.</text>
                </g>
                <g class="kg_stage5">
                    <text x="500" y="775" text-anchor="middle" dominant-baseline="central">Your diagram shows a <tspan id="kg_answer2" font-weight="bold" dominant-baseline="central">X%</tspan> overlap.</text>
                </g>
                <g class="kg_stage6">
                    <text x="500" y="775" text-anchor="middle" dominant-baseline="central">Your diagram shows a <tspan id="kg_answer3" font-weight="bold" dominant-baseline="central">X%</tspan> overlap.</text>
                </g>
            </g>
        </g>
        <g class="buttons">
            <g id="kg0_buttons" class="kg_stage0"></g>
            <g id="kg1_buttons" class="kg_stage1"></g>
            <g id="kg2_buttons" class="kg_stage2"></g>
            <g id="kg3_buttons" class="kg_stage3"></g>
            <g id="kg4_buttons" class="kg_stage4"></g>
            <g id="kg5_buttons" class="kg_stage5"></g>
            <g id="kg6_buttons" class="kg_stage6"></g>
            <g id="kg7_buttons" class="kg_stage7"></g>
        </g>
    </svg>

    <script>
        d3.selectAll(".kg_stage0").style("display", "block");
        d3.selectAll(".kg_stage0").style("opacity", "1");


        create_circle("genome_circle", 500, 500, 467.5491/2);
        create_circle("variants_circle", 400, 500, 54.2945/2, "rgba(255,0,0,0.2)");
        
        create_circle("common_circle", 400, 555, 27.4473/2, "rgba(0,0,255,0.2)");


        var ACB_radius = 213.02/2;
        var CEU_radius = 180/2;
        var MXL_radius = 179.02/2;

        create_circle("ACB_circle", 400, 500, ACB_radius, "rgba(255,0,0,0.2)");
        create_circle("CEU_circle", 600, 550, CEU_radius, "rgba(0,255,0,0.2)");
        create_circle("MXL_circle", 470, 690, MXL_radius, "rgba(0,0,255,0.2)");

        create_interactive_circle(
            "ACB_CEU_ACB",
            500,
            550,
            ACB_radius,
            "rgba(255,0,0,0.2)",
            3,
            "ACB_CEU_CEU",
            550,
            CEU_radius,
            "kg_answer1"
        );
        create_interactive_circle(
            "ACB_CEU_CEU",
            550,
            550,
            CEU_radius,
            "rgba(0,255,0,0.2)",
            3,
            "ACB_CEU_ACB",
            500,
            ACB_radius,
            "kg_answer1"
        );

        create_interactive_circle(
            "ACB_MXL_ACB",
            500,
            550,
            ACB_radius,
            "rgba(255,0,0,0.2)",
            3,
            "ACB_MXL_MXL",
            550,
            MXL_radius,
            "kg_answer2"
        );
        create_interactive_circle(
            "ACB_MXL_MXL",
            550,
            550,
            MXL_radius,
            "rgba(0,0,255,0.2)",
            3,
            "ACB_MXL_ACB",
            500,
            ACB_radius,
            "kg_answer2"
        );

        create_interactive_circle(
            "CEU_MXL_CEU",
            500,
            550,
            CEU_radius,
            "rgba(0,255,0,0.2)",
            3,
            "CEU_MXL_MXL",
            550,
            MXL_radius,
            "kg_answer3"
        );
        create_interactive_circle(
            "CEU_MXL_MXL",
            550,
            550,
            MXL_radius,
            "rgba(0,0,255,0.2)",
            3,
            "CEU_MXL_CEU",
            500,
            CEU_radius,
            "kg_answer3"
        );

        create_button("kg0_buttons", "kg0_next", "Next", 450, 900, 100, 50);
        create_button("kg1_buttons", "kg1_next", "Next", 450, 900, 100, 50);
        create_button("kg2_buttons", "kg2_next", "Next", 450, 900, 100, 50);
        create_button("kg3_buttons", "kg3_next", "Next", 450, 900, 100, 50);
        create_button("kg4_buttons", "kg4_submit", "Submit", 425, 900, 150, 50);
        create_button("kg5_buttons", "kg5_submit", "Submit", 425, 900, 150, 50);
        create_button("kg6_buttons", "kg6_submit", "Submit", 425, 900, 150, 50);
        create_button("kg7_buttons", "kg7_next", "Complete", 450, 900, 100, 50);

        d3.select("#kg0_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage0").style("display", "none");
                d3.selectAll(".kg_stage1").style("display", "block").transition().style("opacity", "1");
            });

        d3.select("#kg1_next")
            .on("click", function(event, d) {
                d3.selectAll("#genome_circle").transition().attr("transform", "translate(0, 55)");
                d3.selectAll("#variants_circle").transition().attr("transform", "translate(0, 55)");

                d3.selectAll("#variants_circle>path").style("fill", "none");

                d3.selectAll("#measureable").transition().attr("transform", "translate(0, 55)");
                d3.selectAll("#observed").transition().attr("transform", "translate(0, 55)");
                
                d3.selectAll(".kg_stage1").style("display", "none");
                d3.selectAll(".kg_stage2").style("display", "block").transition().style("opacity", "1");
            });
        
        d3.select("#kg2_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage2").style("display", "none");
                d3.selectAll(".kg_stage3").style("display", "block").transition().style("opacity", "1");
            });

        d3.select("#kg3_next")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage3").style("display", "none");
                d3.selectAll(".kg_stage4").style("display", "block").transition().style("opacity", "1");
            });

        d3.select("#kg4_submit")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage4").style("display", "none");
                d3.selectAll(".kg_stage5").style("display", "block").transition().style("opacity", "1");
                d3.select("#kg_answer1_table").text(d3.select("#kg_answer1").text());
            });
        
        d3.select("#kg5_submit")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage5").style("display", "none");
                d3.selectAll(".kg_stage6").style("display", "block").transition().style("opacity", "1");
                d3.select("#kg_answer2_table").text(d3.select("#kg_answer2").text());
            });

        d3.select("#kg6_submit")
            .on("click", function(event, d) {
                d3.selectAll(".kg_stage6").style("display", "none");
                d3.selectAll(".kg_stage7").style("display", "block").transition().style("opacity", "1");
                d3.select("#kg_answer3_table").text(d3.select("#kg_answer3").text());
            });
        
    </script>
</div>