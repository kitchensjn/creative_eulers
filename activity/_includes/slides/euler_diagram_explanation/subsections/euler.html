<style>
    #cat_circle, #dog_circle {
        transition: 1s;
    }

    .stage1, .stage2, .stage3, .stage4 {
        display: none;
        opacity: 0;
        transition: 1s;
    }
</style>

<g id="explanation">
    <g class="text-content">
        <g class="stage0">
            <text x="100" y="100">Youâ€™ve likely thought about the overlap between groups</text>
            <text x="100" y="150">in contexts outside of genetics. Say you interviewed</text>
            <text x="100" y="200">100 pet owners and generated the following table.</text>
        </g>
        <g class="stage1">
            <text x="100" y="100">We can redraw this table as a <tspan font-weight="bold">Venn diagram</tspan> where</text>
            <text x="100" y="150">the circles are the same size...</text>
        </g>
        <g class="stage2">
            <text x="100" y="100">Or as an <tspan font-weight="bold">Euler diagram</tspan>, which scales area</text>
            <text x="100" y="150">proportional to the count of that category.</text>
        </g>
        <g class="stage3">
            <text x="100" y="100">We can convert these counts into percentages by</text>
            <text x="100" y="150">dividing by the total number of individuals included in</text>
            <text x="100" y="200">the diagram (<tspan font-weight="bold">25+10+50=85</tspan> unique people that own</text>
            <text x="100" y="250">cats or dogs).</text>
        </g>
        <g class="stage4">
            <text x="100" y="100">Importantly, if the circles are different sizes, their</text>
            <text x="100" y="150">overlap will be <tspan font-weight="bold">less than 100%</tspan> even if one circle is</text>
            <text x="100" y="200">entirely enclosed by the other.</text>
        </g>
    </g>
    <g class="diagram" id="pet_owner_percentages">
        
        <g class="stage0">
            <g id="table_lines"></g>
            <text x="250" y="350" text-anchor="middle" dominant-baseline="central">Own a...</text>
            <text x="500" y="325" text-anchor="middle" dominant-baseline="central">Dog</text>
            <text x="425" y="375" text-anchor="middle" dominant-baseline="central">Yes</text>
            <text x="575" y="375" text-anchor="middle" dominant-baseline="central">No</text>
            <text text-anchor="middle" dominant-baseline="central" transform="translate(272, 550) rotate(-90)">Cat</text>
            <text text-anchor="middle" dominant-baseline="central" transform="translate(322, 475) rotate(-90)">Yes</text>
            <text text-anchor="middle" dominant-baseline="central" transform="translate(322, 625) rotate(-90)">No</text>
            <text x="425" y="475" font-size=1.5em text-anchor="middle" dominant-baseline="central">10</text>
            <text x="575" y="475" font-size=1.5em text-anchor="middle" dominant-baseline="central">25</text>
            <text x="425" y="625" font-size=1.5em text-anchor="middle" dominant-baseline="central">50</text>
            <text x="575" y="625" font-size=1.5em text-anchor="middle" dominant-baseline="central">15</text>
            <g id="table_annotation">
                <line x1="625" y1="625" x2="690" y2="625" stroke="black" stroke-width="1"></line>
                <text x="700" y="590" font-size="0.7em" dominant-baseline="central">These people own a pet</text>
                <text x="700" y="615" font-size="0.7em" dominant-baseline="central">other than a dog or cat.</text>
                <text x="700" y="640" font-size="0.7em" dominant-baseline="central">We will come back to</text>
                <text x="700" y="665" font-size="0.7em" dominant-baseline="central">them later.</text>
            </g>
        </g>
        <g class="stage1 stage2 stage3 stage4">
            <g id="cat_circle"></g>
            <g id="dog_circle"></g>
        </g>
        <g class="numbers">
            <g class="stage1">
                <text x="325" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>25</text>
                <text x="500" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>10</text>
                <text x="675" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>50</text>
            </g>
            <g class="stage2">
                <text x="325" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>25</text>
                <text x="455" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>10</text>
                <text x="650" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>50</text>
            </g>
            <g class="stage3">
                <text x="325" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>29%</text>
                <text x="455" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>12%</text>
                <text x="650" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>59%</text>
            </g>
            <g class="stage4">
                <text x="500" y="500" text-anchor="middle" dominant-baseline="central" font-size=1.5em>58%</text>
                <text x="500" y="690" text-anchor="middle" dominant-baseline="central" font-size=1.5em>42%</text>
            </g>
        </g>
        <g class="annotations">
            <g class="stage1">
                <g>
                    <line x1="300" y1="675" x2="275" y2="700" stroke="black" stroke-width="1"></line>
                    <line x1="275" y1="700" x2="250" y2="700" stroke="black" stroke-width="1"></line>
                    <text x="175" y="675" text-anchor="middle" dominant-baseline="central" font-size="0.7em">35</text>
                    <text x="175" y="700" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Cat Owners</text>
                </g>
                <g>
                    <line x1="700" y1="325" x2="725" y2="300" stroke="black" stroke-width="1"></line>
                    <line x1="725" y1="300" x2="750" y2="300" stroke="black" stroke-width="1"></line>
                    <text x="825" y="275" text-anchor="middle" dominant-baseline="central" font-size="0.7em">60</text>
                    <text x="825" y="300" text-anchor="middle" dominant-baseline="central" font-size="0.7em">Dog Owners</text>
                </g>
            </g>
        </g>
    </g>
    <g class="buttons">
        <g id="table_buttons" class="buttons"></g>
        <g id="venn_buttons" class="stage1"></g>
        <g id="euler_buttons" class="stage2"></g>
        <g id="percentages_buttons" class="stage3"></g>
        <g id="clarification_buttons" class="stage4"></g>
    </g>
</g>

<script>
    var table_container = document.getElementById("table_lines");
    var rc = rough.svg(table_container);
    
    var outer = rc.rectangle(350, 400, 300, 300, {
        fill: "rgba(0,255,0,0.2)",
        fillStyle: "solid",
        strokeWidth: "3"
    });
    table_container.appendChild(outer.children[0]);
    table_container.appendChild(outer.children[0]);

    var horizontal = rc.line(350, 550, 650, 550, {
        strokeWidth: "3"
    });
    table_container.appendChild(horizontal.children[0]);

    var vertical = rc.line(500, 400, 500, 700, {
        strokeWidth: "3"
    });
    table_container.appendChild(vertical.children[0]);

    var cat_container = document.getElementById("cat_circle");
    var rc = rough.svg(cat_container);
    var cat = rc.circle(400, 500, 190*2, {
    //var cat = rc.circle(357.1957, 500, 166.8896*2, {
        fill: "rgba(255,0,0,0.2)",
        fillStyle: "solid",
        strokeWidth: "3"
    });
    cat_container.appendChild(cat.children[0]);
    cat_container.appendChild(cat.children[0]);

    var dog_container = document.getElementById("dog_circle");
    var rc = rough.svg(dog_container);
    var dog = rc.circle(600, 500, 190*2, {
    //var dog = rc.circle(614.7972, 500, 218.5097*2, {
        fill: "rgba(0,0,255,0.2)",
        fillStyle: "solid",
        strokeWidth: "3"
    });
    dog_container.appendChild(dog.children[0]);
    dog_container.appendChild(dog.children[0]);

    d3.selectAll(".stage0").style("display", "block");

    create_button("table_buttons", "table_next", "Next", 450, 850, 100, 50);
    d3.select("#table_next")
        .on("click", function(event, d) {
            d3.selectAll(".stage0").style("display", "none");
            d3.selectAll(".stage1").style("display", "block");
            d3.selectAll(".stage1").style("opacity", "1");
        });

    create_button("venn_buttons", "venn_next", "Next", 450, 850, 100, 50);
    d3.select("#venn_next")
        .on("click", function(event, d) {
            d3.selectAll(".stage1").style("display", "none");
            d3.selectAll(".stage2").style("display", "block");
            d3.selectAll(".stage2").style("opacity", "1");
            d3.select("#cat_circle")
                .attr("transform", "translate(-42.8043, 0) scale(0.87836632)")
                .style("transform-origin", "center")
                .style("transform-box", "fill-box");    
            d3.select("#dog_circle")
                .attr("transform", "translate(14.7972, 0) scale(1.15005105)")
                .style("transform-origin", "center")
                .style("transform-box", "fill-box");
        });

    create_button("euler_buttons", "euler_next", "Next", 450, 850, 100, 50);
    d3.select("#euler_next")
        .on("click", function(event, d) {
            d3.selectAll(".stage2").style("display", "none");
            d3.selectAll(".stage3").style("display", "block");
            d3.selectAll(".stage3").style("opacity", "1");
        });

    create_button("percentages_buttons", "percentages_next", "Next", 450, 850, 100, 50);
    d3.select("#percentages_next")
        .on("click", function(event, d) {
            d3.selectAll(".stage3").style("display", "none");
            d3.selectAll(".stage4").style("display", "block");
            d3.selectAll(".stage4").style("opacity", "1");
            d3.select("#cat_circle").attr("transform", "translate(100, 0) scale(0.87836632)");
            d3.select("#dog_circle").attr("transform", "translate(-100, 0) scale(1.15005105)");
        });
    
    create_button("clarification_buttons", "clarification_next", "Next", 450, 850, 100, 50);
    d3.select("#clarification_next")
        .on("click", function(event,d) {
                $(".carousel").carousel("next");
            });
</script>